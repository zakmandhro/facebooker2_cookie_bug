<!DOCTYPE html>
<html>
<head>
  <title>Fb2</title>
  <%= stylesheet_link_tag :all %>
  <%= javascript_include_tag :defaults %>
  <%= csrf_meta_tag %>
</head>
<body>

<script> 
  window.fbAsyncInit = function() {
    FB.init({
      appId  : '136a2644b168922f7974a27165cda8e9',
      status : true, // check login status
      cookie : true, // enable cookies to allow the server to access the session
      xfbml  : true  // parse XFBML
    });
    
  };

  (function() {
    var s = document.createElement('div'); 
    s.setAttribute('id','fb-root'); 
    document.documentElement.getElementsByTagName("body")[0].appendChild(s);
    var e = document.createElement('script');
    e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
    e.async = true;
    s.appendChild(e);
  }());
</script>

<% if current_facebook_user %>
   <%= "Hello #{fb_name(current_facebook_user, :useyou => false)}!".html_safe # link to facebook profile
    %>
  <%= fb_logout_link("Logout of fb", request.url) %><br />
<% else
   # you must explicitly request permissions for facebook user fields.
   # here we instruct facebook to ask the user for permission for our website
   # to access the user's facebook email and birthday
   %>
  <%= fb_login_and_redirect(root_url, :perms => 'email,user_birthday') %>
<% end %>

<%= yield %>

</body>
</html>
